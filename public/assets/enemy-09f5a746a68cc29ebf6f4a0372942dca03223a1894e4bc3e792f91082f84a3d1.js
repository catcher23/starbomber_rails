!function(){"undefined"==typeof Starbomber&&(window.Starbomber={});var e=Starbomber.Enemy=function(t){this.pos=t.pos,this.game=t.game,t.radius=e.RADIUS,t.vel=t.vel||[0,0],t.color=t.color||"lightgreen",this.collisionCounter=!1,this.justHit=!1,this.life=3,this.enemy=new Image,this.enemy2=new Image,this.enemy.src="images/efighter2.png",this.enemy2.src="images/efighter.png",random=Math.random(),this.speed=1.8*random,this.angle=0,Starbomber.MovingObject.call(this,t)};e.RADIUS=15,Starbomber.Util.inherits(e,Starbomber.MovingObject),e.prototype.fireEbullet=function(){var e=(Starbomber.Util.norm(this.vel),Starbomber.Util.scale(Starbomber.Util.dir(this.vel),Starbomber.Ebullet.SPEED),this),t=[Math.cos(e.angle)*Starbomber.Ebullet.SPEED,Math.sin(e.angle)*Starbomber.Ebullet.SPEED],i=new Starbomber.Ebullet({pos:this.pos,vel:t,color:this.color,game:this.game});this.game.add(i)},e.prototype.power=function(e){this.vel[0]+=e[0],this.vel[1]+=e[1]},e.prototype.relocate=function(){this.pos=this.game.centerPosition(),this.vel=[0,0]},e.prototype.render=function(e){},e.prototype.draw=function(e){enemy="",this.justHit?(that=this,setTimeout(function(){that.justHit=!1},100),enemy=this.enemy):enemy=this.enemy2,e.translate(this.pos[0],this.pos[1]),e.rotate(this.angle),e.translate(-this.pos[0],-this.pos[1]),e.drawImage(enemy,this.pos[0]-23,this.pos[1]-23,this.radius*Math.PI,this.radius*Math.PI),e.setTransform(1,0,0,1,0,0)},e.prototype.explode=function(){var e=(Starbomber.Util.norm(this.vel),Starbomber.Util.scale(Starbomber.Util.dir(this.vel),Starbomber.Explosion.SPEED)),t=[.7*e[0]+.5*this.vel[0],.7*e[1]+.5*this.vel[1]],i=new Starbomber.Explosion({pos:this.pos,enemyExp:!0,vel:t,color:this.color,game:this.game});if(this.game.add(i),0==this.game.enemies.length&&2!==this.game.NUM_ENEMIES){var s=this;setTimeout(function(){s.game.wave+=1,$("#scoreBoard").html("Your Score : "+s.game.score+" - Your Life : "+s.game.life+" - Wave : "+s.game.wave),s.game.nextLevel()},1e3)}},e.prototype.collideWith=function(e){if(e instanceof Starbomber.Asteroid||e instanceof Starbomber.Ship){0==this.collisionCounter&&(this.vel=[e.vel[0]-this.vel[0],e.vel[1]-this.vel[1]],e.vel=[e.vel[0]-this.vel[0],e.vel[1]-this.vel[1]],this.vel[0]>4&&(this.vel[0]=4),this.vel[0]<-4&&(this.vel[0]=-4),this.vel[1]>4&&(this.vel[1]=4),this.vel[1]<-4&&(this.vel[1]=-4),e.vel[0]>4&&(e.vel[0]=4),e.vel[0]<-4&&(e.vel[0]=-4),e.vel[1]>4&&(e.vel[1]=4),e.vel[1]<-4&&(e.vel[1]=-4),this.collisionCounter=!0,this.justHit=!0,this.life-=1,this.life<1&&(this.remove(),this.explode(),$("#scoreBoard").html("Your Score : "+this.game.score+" - Your Life : "+this.game.life+" - Wave : "+this.game.wave)));var t=this;setTimeout(function(){t.collisionCounter=!1},600)}},e.prototype.power=function(){this.vel[0]=2*Math.cos(this.angle)*this.speed,this.vel[1]=2*Math.sin(this.angle)*this.speed,Starbomber.Util.dist(this.pos,this.game.ships[0].pos)<250&&(this.vel=[0,0])},e.prototype.move=function(){p1=this.game.ships[0].pos,p2=this.pos,this.angle=Math.atan2(p1[1]-p2[1],p1[0]-p2[0]),this.pos=[this.pos[0]+this.vel[0],this.pos[1]+this.vel[1]],random=Math.random(),random>.98&&this.fireEbullet(),this.power(),this.game.isOutOfBounds(this.pos)&&(this.isWrappable?this.pos=this.game.wrap(this.pos):this.remove())}}();