!function(){"undefined"==typeof Starbomber&&(window.Starbomber={});var t=Starbomber.Game=function(){this.asteroids=[],this.bullets=[],this.ebullets=[],this.guidebullets=[],this.ships=[],this.explosions=[],this.enemies=[],this.addStarbomber(),this.addEnemies(),this.score=0,this.life=30,this.highScore=0,this.wave=1,$("div.scoreBoard").show()};t.BG_COLOR="#000000",t.DIM_X=1400,t.DIM_Y=800,t.FPS=32,t.NUM_Starbomber=8,t.NUM_ENEMIES=1,t.prototype.add=function(t){if(t instanceof Starbomber.Asteroid)this.asteroids.push(t);else if(t instanceof Starbomber.Bullet)this.bullets.push(t);else if(t instanceof Starbomber.Ebullet)this.ebullets.push(t);else if(t instanceof Starbomber.Guidebullet)this.ebullets.push(t);else if(t instanceof Starbomber.Ship)this.ships.push(t);else if(t instanceof Starbomber.Enemy)this.enemies.push(t);else{if(!(t instanceof Starbomber.Explosion))throw"wtf?";this.explosions.push(t)}},t.prototype.addStarbomber=function(){for(var e=0;e<t.NUM_Starbomber;e++)this.add(new Starbomber.Asteroid({game:this}))},t.prototype.addEnemies=function(){for(var e=0;e<t.NUM_ENEMIES;e++){var i=this.randomPosition(),s=new Starbomber.Explosion({pos:i,bigExp:!0,vel:[0,0],color:this.color,game:this});this.add(s),this.add(new Starbomber.Enemy({pos:i,game:this}))}},t.prototype.addShip=function(){var t=new Starbomber.Ship({pos:this.centerPosition(),game:this});return this.add(t),t},t.prototype.reset=function(){this.enemies=[];var t=new Starbomber.Ship({pos:this.centerPosition(),game:this});this.add(t)},t.prototype.allObjects=function(){return[].concat(this.ships,this.asteroids,this.bullets,this.ebullets,this.explosions,this.enemies)},t.prototype.checkCollisions=function(){var t=this;this.allObjects().forEach(function(e){t.allObjects().forEach(function(i){e!=i&&(e.isCollidedWith(i)&&e.collideWith(i),e instanceof Starbomber.Bullet&&i instanceof Starbomber.Enemy&&e.inProximityOf(i)&&t.ships[0].proximityTarget(i))})})},t.prototype.render=function(t){this.allObjects().forEach(function(e){e.render(t)})},t.prototype.draw=function(t){this.allObjects().forEach(function(e){e.draw(t)})},t.prototype.isOutOfBounds=function(e){return e[0]<0||e[1]<0||e[0]>t.DIM_X||e[1]>t.DIM_Y},t.prototype.moveObjects=function(){this.allObjects().forEach(function(t){t.move()})},t.prototype.randomPosition=function(){return[t.DIM_X*Math.random(),t.DIM_Y*Math.random()]},t.prototype.centerPosition=function(){return[.5*t.DIM_X,.5*t.DIM_Y]},t.prototype.remove=function(t){if(t instanceof Starbomber.Bullet)this.bullets.splice(this.bullets.indexOf(t),1);else if(t instanceof Starbomber.Asteroid){var e=this.asteroids.indexOf(t);this.asteroids[e]=new Starbomber.Asteroid({game:this})}else if(t instanceof Starbomber.Ship)this.ships.splice(this.ships.indexOf(t),1);else if(t instanceof Starbomber.Ebullet)this.ebullets.splice(this.ebullets.indexOf(t),1);else if(t instanceof Starbomber.Guidebullet)this.guidebullets.splice(this.guidebullets.indexOf(t),1);else if(t instanceof Starbomber.Enemy)this.enemies.splice(this.enemies.indexOf(t),1);else{if(!(t instanceof Starbomber.Explosion))throw"wtf?";this.explosions.splice(this.explosions.indexOf(t),1)}},t.prototype.step=function(){this.moveObjects(),this.checkCollisions()},t.prototype.gameOver=function(){$("div.gameOver").show("fast",function(){$(this).animate({top:310},"slow")}),setTimeout(function(){$("div.gameOver2").fadeIn({top:440},"slow")},800),setTimeout(function(){$("div.nameScore").fadeIn({top:440},"slow")},800)},t.prototype.nextLevel=function(){var e=this;$("div.next").show("slow",function(){$(this).animate({top:280},"slow")}),setTimeout(function(){$("div.next").fadeOut("linear")},1600),setTimeout(function(){t.NUM_ENEMIES=t.NUM_ENEMIES+=1,t.NUM_ENEMIES*e.addEnemies()},3600)},t.prototype.wrap=function(e){function i(t,e){return 0>t?e-t%e:t>e?t%e:t}return[i(e[0],t.DIM_X),i(e[1],t.DIM_Y)]}}();